define(["jsingleton","jcontroller/subcontrollers/listenerController","jcontroller/jcontroller"],function(e,t,n){var r=/(id|class|href|action|method|type|value|rel|for|style|title|name|width|height|alt)/i,i=/(click|mouseover|mouseout|mouseup|mousemove)/,s=/(controller)/i,o=/\{\{([^\}]+)\}\}/g,u={allContent:function(t,n){var r="";for(var i=0;i<t.length;i++)t[i]instanceof Object?t[i].TYPE!==undefined&&t[i].TYPE==="placeholder"?r+=e.singleton.views[t[i].name].render(n):r+=t[i].render(n):r+=this.getTextOrPlaceholder(t[i],n);return r},getTextOrPlaceholder:function(e,t){return e=e.replace(o,function(e){var n=e.substr(2,e.length-4);return t[n]!==undefined?t[n]:"*undefined varaible "+n+"*"}),e},getIdentifiers:function(e){var t="";for(var n in e)if(n.search(r)>-1)t+=this.getIdentifiersHelper(e[n],n);else{if(!(n.search(s)>-1&&n.search(i)>-1))throw"unidentified tag in view";t+=this.addTagListener(e[n],n,e.id)}return t},getIdentifiersHelper:function(e,t){return" "+t+"="+this.addQuotes(e)},addTagListener:function(e,r,i){var s;i===undefined?s="1234":s=i;var o=r.split("-"),u=e.split(".");return o[1]==="controller"&&t(o[0],function(e){n.callController(u[0],u[1])},!0).bindToElement("#"+s),i===undefined?' id="'+s+'"':""},addQuotes:function(e){return e.charAt(0)==='"'?e:'"'+e+'"'}};return u});